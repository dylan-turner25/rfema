<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dylan Turner" />

<meta name="date" content="2022-01-08" />

<title>rfema: Getting Started</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">rfema: Getting Started</h1>
<h4 class="author">Dylan Turner</h4>
<h4 class="date">2022-01-08</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette provides a brief overview on using the <code>rfema</code> package to obtain data from the Open FEMA API. The rest of this vignette covers how to install the package, followed by examples on using the package to obtain data for various objectives.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Right now, the best way to install and use the <code>rfema</code> package is by installing directly from GitHub using <code>remotes::install_github(&quot;dylan-turner25/rfema&quot;)</code>. The FEMA API does not require and API key, meaning no further setup steps need be taken to start using the package</p>
</div>
<div id="avaliable-datasets" class="section level2">
<h2>Avaliable Datasets</h2>
<p>For those unfamiliar with the data sets available through the FEMA API, a good starting place is to visit the <a href="https://www.fema.gov/about/openfema/data-sets">FEMA API documentation page</a>. However, if you are already familiar with the data and want to quickly reference the data set names or another piece of meta data, using the <code>fema_data_sets()</code> function to obtain a tibble of available data sets along with associated meta data is a convenient option.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the avaliable data sets as an object in your R environment that can be referenced later</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data_sets <span class="ot">&lt;-</span> <span class="fu">fema_data_sets</span>() </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view data </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data_sets</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 37 × 64</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    identifier name  title description distribution.ac… distribution.fo… distribution.da… distribution.ac… distribution.fo… distribution.da… distribution.ac…</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 openfema-1 Publ… Publ… FEMA provi… https://www.fem… csv              small (10MB - 5… https://www.fem… json             medium (50MB - … https://www.fem…</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 openfema-1 Publ… Publ… FEMA provi… https://www.fem… csv              small (10MB - 5… https://www.fem… json             medium (50MB - … https://www.fem…</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 openfema-… Fema… FEMA… This data … https://www.fem… csv              medium (50MB - … https://www.fem… json             medium (50MB - … https://www.fem…</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 openfema-… Haza… Haza… This datas… https://www.fem… csv              small (10MB - 5… https://www.fem… json             small (10MB - 5… https://www.fem…</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 openfema-… Fema… FEMA… Provides t… https://www.fem… csv              tiny (&lt; 10 MB)   https://www.fem… json             tiny (&lt; 10 MB)   https://www.fem…</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 openfema-… Emer… Emer… This datas… https://www.fem… csv              tiny (&lt; 10MB)    https://www.fem… json             tiny (&lt; 10MB)    https://www.fem…</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 openfema-… Haza… Haza… The datase… https://www.fem… csv              small (10MB - 5… https://www.fem… json             small (10MB - 5… https://www.fem…</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 openfema-… Hous… Hous… This datas… https://www.fem… csv              small (10MB - 5… https://www.fem… json             medium (50MB - … https://www.fem…</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 openfema-8 Data… Open… Metadata f… https://www.fem… csv              tiny (&lt; 10MB)    https://www.fem… json             tiny (&lt; 10MB)    https://www.fem…</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 openfema-… Haza… Haza… This datas… https://www.fem… csv              small (10MB - 5… https://www.fem… json             medium (50MB - … https://www.fem…</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 27 more rows, and 53 more variables: distribution.format.2 &lt;chr&gt;, distribution.datasetSize.2 &lt;chr&gt;, webService &lt;chr&gt;, dataDictionary &lt;chr&gt;,</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   keyword &lt;chr&gt;, modified &lt;chr&gt;, publisher &lt;chr&gt;, contactPoint &lt;chr&gt;, mbox &lt;chr&gt;, accessLevel &lt;chr&gt;, landingPage &lt;chr&gt;, temporal &lt;chr&gt;, api &lt;chr&gt;,</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   version &lt;chr&gt;, bureauCode &lt;chr&gt;, programCode &lt;chr&gt;, accessLevelComment &lt;chr&gt;, license &lt;chr&gt;, spatial &lt;chr&gt;, theme &lt;chr&gt;, dataQuality &lt;chr&gt;,</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   accrualPeriodicity &lt;chr&gt;, language &lt;chr&gt;, primaryITInvestmentUII &lt;chr&gt;, issued &lt;chr&gt;, systemOfRecords &lt;chr&gt;, deprecated &lt;chr&gt;, hash &lt;chr&gt;,</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   lastRefresh &lt;chr&gt;, recordCount &lt;chr&gt;, depApiMessage &lt;chr&gt;, depNewURL &lt;chr&gt;, depWebMessage &lt;chr&gt;, lastDataSetRefresh &lt;chr&gt;, id &lt;chr&gt;, accessUrl &lt;chr&gt;,</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   format &lt;chr&gt;, depDate &lt;chr&gt;, keyword1 &lt;chr&gt;, keyword2 &lt;chr&gt;, keyword3 &lt;chr&gt;, keyword4 &lt;chr&gt;, keyword5 &lt;chr&gt;, keyword6 &lt;chr&gt;, keyword7 &lt;chr&gt;,</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   keyword8 &lt;chr&gt;, keyword9 &lt;chr&gt;, keyword10 &lt;chr&gt;, keyword11 &lt;chr&gt;, keyword12 &lt;chr&gt;, keyword13 &lt;chr&gt;, keyword14 &lt;chr&gt;, references &lt;chr&gt;</span></span></code></pre></div>
</div>
<div id="example-workflow" class="section level2">
<h2>Example Workflow</h2>
<p>Once we know what data set we want to access, or perhaps if we want to know more about what data is available in a given data set, we can use the <code>fema_data_fields()</code> function to get a look at the available data fields in a given data set by setting the “data_set” parameter to one of the “name” columns in the data frame returned by the <code>fema_data_sets()</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain all the data fields for the NFIP Policies data set</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">fema_data_fields</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipPolicies&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: the data set field is not case sensative, meaning you do not need to </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use camel case names despite that being the convention in the FEMA documentation.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">fema_data_fields</span>(<span class="at">data_set =</span> <span class="st">&quot;fimanfippolicies&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># view the data fields </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 46 × 15</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    datasetId   openFemaDataSet  name  title  description type   sortOrder datasetVersion hash  lastRefresh isNestedObject isNullable isSearchable primaryKey</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;     </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 openfema-32 FimaNfipPolicies 1     agric… Agricultur… Yes (… boolean   1              FALSE FALSE       FALSE          &quot;&quot;         aecf8b7e731… 2021-09-0…</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 openfema-32 FimaNfipPolicies 1     baseF… Base Flood… Base … number    2              TRUE  FALSE       TRUE           &quot;NULL&quot;     e715e5e9ef7… 2021-11-2…</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 openfema-32 FimaNfipPolicies 1     basem… Basement E… Basem… number    3              TRUE  FALSE       FALSE          &quot;&quot;         7b8e36bb146… 2021-09-0…</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 openfema-32 FimaNfipPolicies 1     cance… Cancellati… The c… date      4              TRUE  FALSE       TRUE           &quot;NULL&quot;     b2ccd296d07… 2021-12-0…</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 openfema-32 FimaNfipPolicies 1     condo… Condominiu… This … string    6              TRUE  FALSE       FALSE          &quot;&quot;         765e99726f1… 2021-09-0…</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 openfema-32 FimaNfipPolicies 1     censu… Census Tra… US Ce… string    5              TRUE  FALSE       FALSE          &quot;&quot;         438bdf12461… 2021-09-0…</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 openfema-32 FimaNfipPolicies 1     count… County Code FIPS … string    8              TRUE  FALSE       FALSE          &quot;&quot;         b720c88f821… 2021-09-0…</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 openfema-32 FimaNfipPolicies 1     crsCl… CRS Classi… The C… number    9              TRUE  FALSE       FALSE          &quot;&quot;         35c68c6288c… 2021-09-0…</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 openfema-32 FimaNfipPolicies 1     const… Constructi… Is th… boolean   7              FALSE FALSE       FALSE          &quot;&quot;         4fc98de7ae5… 2021-09-0…</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 openfema-32 FimaNfipPolicies 1     deduc… Deductible… The t… number    10             TRUE  FALSE       FALSE          &quot;NULL&quot;     5619a57e826… 2021-11-2…</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 36 more rows, and 1 more variable: id &lt;chr&gt;</span></span></code></pre></div>
<p>The FEMA API limits the number of records that can be returned in a single query to 1000, meaning if we want more observations than that, a loop is necessary to iterate over multiple API calls. The <code>open_fema</code> functions handles this process this automatically, but by default will issue a warning letting you know how many records match your criteria and how many API calls it will take to retrieve all those records and ask you to confirm the request before it starts retrieving data (this behavior can be turned off by setting the <code>ask_before_call</code> argument to <code>FALSE</code>). Additionally an estimated time will be issued to give you a sense of how long it will take to complete the request. For example, requesting the entire NFIP claims data set via <code>open_fema(data_set = &quot;fimaNfipClaims&quot;)</code> will yield the following output in the R console.</p>
<pre><code>#&gt; Calculating estimated API call time...
#&gt; 2564279 matching records found. At 1000 records per call, it will take 2565 individual API calls to get all matching records. It&#39;s estimated that this will take approximately 1.88 hours. Continue?
#&gt; [1] 1 - Yes, get that data!, 0 - No, let me rethink my API call:</code></pre>
<p>Note that the estimated time is based on network conditions at the initial time the call is being made and may not be accurate for large data requests that take long enough for network conditions to potential change significantly during the request. As an aside, for large data requests, like downloading the entire data set, it will usually be faster to perform a bulk download using the <code>bulk_dl</code> function.</p>
<p>Alternatively, we could specify the top_n argument to limit the number of records returned. Specifying top_n greater than 1000 will initiate the same message letting you know how many iterations it will take to get your data. If top_n is less than 1000, the API call will be automatically be carried out. In the case below, we will return the first 10 records from the NFIP Claims data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>, <span class="at">top_n =</span> <span class="dv">10</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 40</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    agricultureStructureIndicator asOfDate            baseFloodElevat… basementEnclosu… reportedCity condominiumIndi… policyCount countyCode communityRating…</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                         &lt;dttm&gt;              &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;           </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 FALSE                         2021-07-25 00:00:00 7                NULL             Temporarily… N                1           51199      7               </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 FALSE                         2021-07-25 00:00:00 NULL             1                Temporarily… N                1           24033      5               </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           22073      10              </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 FALSE                         2021-09-30 00:00:00 5                NULL             Temporarily… N                1           12091      5               </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 FALSE                         2021-07-25 00:00:00 11               NULL             Temporarily… N                1           22103      7               </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           36103      NULL            </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           48201      5               </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           12033      7               </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           37055      7               </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 FALSE                         2021-07-25 00:00:00 49               NULL             Temporarily… N                1           48201      5               </span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 31 more variables: dateOfLoss &lt;dttm&gt;, elevatedBuildingIndicator &lt;chr&gt;, elevationCertificateIndicator &lt;chr&gt;, elevationDifference &lt;chr&gt;,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   censusTract &lt;chr&gt;, floodZone &lt;chr&gt;, houseWorship &lt;chr&gt;, latitude &lt;chr&gt;, longitude &lt;chr&gt;, locationOfContents &lt;chr&gt;, lowestAdjacentGrade &lt;chr&gt;,</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   lowestFloorElevation &lt;chr&gt;, numberOfFloorsInTheInsuredBuilding &lt;chr&gt;, nonProfitIndicator &lt;chr&gt;, obstructionType &lt;chr&gt;, occupancyType &lt;chr&gt;,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   originalConstructionDate &lt;dttm&gt;, originalNBDate &lt;dttm&gt;, amountPaidOnBuildingClaim &lt;chr&gt;, amountPaidOnContentsClaim &lt;chr&gt;,</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   amountPaidOnIncreasedCostOfComplianceClaim &lt;chr&gt;, postFIRMConstructionIndicator &lt;chr&gt;, rateMethod &lt;chr&gt;, smallBusinessIndicatorBuilding &lt;chr&gt;,</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   state &lt;chr&gt;, totalBuildingInsuranceCoverage &lt;chr&gt;, totalContentsInsuranceCoverage &lt;chr&gt;, yearOfLoss &lt;chr&gt;, reportedZipcode &lt;chr&gt;,</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   primaryResidence &lt;chr&gt;, id &lt;chr&gt;</span></span></code></pre></div>
<p>If we wanted to limit the columns returned we could do so by passing a character vector of data fields to be included in the returned data frame. The data fields for a given data set can be retrieved using the <code>fema_data_fields()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_fields <span class="ot">&lt;-</span> <span class="fu">fema_data_fields</span>(<span class="st">&quot;fimanfipclaims&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data_fields</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 40 × 15</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    datasetId   openFemaDataSet name  title  description  type   sortOrder datasetVersion hash  lastRefresh isNestedObject isNullable isSearchable primaryKey</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;     </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 openfema-31 FimaNfipClaims  1     &quot;agri… &quot;Agricultur… Yes (… boolean   1              FALSE FALSE       FALSE          NULL       91f8c693c90… 2021-11-2…</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 openfema-31 FimaNfipClaims  1     &quot;asOf… &quot;As Of Date&quot; The e… date      2              TRUE  FALSE       FALSE          NULL       d740807d822… 2021-11-2…</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 openfema-31 FimaNfipClaims  1     &quot;base… &quot;Base Flood… Base … number    3              TRUE  FALSE       FALSE          NULL       ff76dc6c963… 2021-11-2…</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 openfema-31 FimaNfipClaims  1     &quot;base… &quot;Basement E… Basem… number    4              TRUE  FALSE       FALSE          NULL       d9ccf2e5435… 2021-11-2…</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 openfema-31 FimaNfipClaims  1     &quot;repo… &quot;Reported C… This … string    5              TRUE  FALSE       FALSE          NULL       0bdb29845d2… 2021-11-2…</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 openfema-31 FimaNfipClaims  1     &quot;cond… &quot;Condominiu… This … string    6              TRUE  FALSE       FALSE          NULL       c75d682cf55… 2021-11-2…</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 openfema-31 FimaNfipClaims  1     &quot;poli… &quot;Policy Cou… Insur… number    7              TRUE  FALSE       FALSE          NULL       3d2b0cef36b… 2021-11-2…</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 openfema-31 FimaNfipClaims  1     &quot;coun… &quot;County Cod… FIPS … string    8              TRUE  FALSE       TRUE           NULL       f78eca3b993… 2021-11-2…</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 openfema-31 FimaNfipClaims  1     &quot;comm… &quot;Community … The C… number    9              TRUE  FALSE       FALSE          NULL       d560e158499… 2021-11-2…</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 openfema-31 FimaNfipClaims  1     &quot;date… &quot;Date Of Lo… Date … date      10             TRUE  FALSE       FALSE          NULL       4b7fe750c3a… 2021-11-2…</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 30 more rows, and 1 more variable: id &lt;chr&gt;</span></span></code></pre></div>
<p>In this case we will return only the <code>policyCount</code> and <code>floodZone</code> columns. As can be seen, an id column is always returned even if the select argument is used.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>, <span class="at">top_n =</span> <span class="dv">10</span>, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;policyCount&quot;</span>,<span class="st">&quot;floodZone&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    policyCount floodZone id                      </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;                   </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 1           AE        619d2db7ca992633f8bcda27</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 1           X         619d2db7ca992633f8bcda25</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 1           AE        619d2db7ca992633f8bcda28</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 1           AE        619d2db7ca992633f8bcda2a</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 1           AE        619d2db7ca992633f8bcda2c</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 1           X         619d2db7ca992633f8bcda2d</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 1           AE        619d2db7ca992633f8bcda31</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 1           C         619d2db7ca992633f8bcda3d</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 1           A         619d2db7ca992633f8bcda43</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 1           AE        619d2db7ca992633f8bcda45</span></span></code></pre></div>
<p>If we want to limit the rows returned rather than the columns, we can also apply filters by specifying values of the columns to return. If we want to quickly see the set of variables that can be used to filter API queries with, we can use the valid_parameters() function to return a tibble containing the variables that are “searchable” for a particular data set.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">valid_parameters</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>params</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 40 × 1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    title                          </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                          </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 agricultureStructureIndicator  </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 asOfDate                       </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 baseFloodElevation             </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 basementEnclosureCrawlspaceType</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 reportedCity                   </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 condominiumIndicator           </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 policyCount                    </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 countyCode                     </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 communityRatingSystemDiscount  </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 dateOfLoss                     </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 30 more rows</span></span></code></pre></div>
<p>We can see from the above that both <code>policyCount</code> and <code>floodZone</code> are both searchable variables. Thus we can specify a list that contains the values of each variable that we want returned in the data frame. Before doing that however, it can be useful to learn a bit more about each parameter by using the <code>parameter_values()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get more information onf the &quot;floodZone&quot; parameter from the NFIP Claims data set</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parameter_values</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>,<span class="at">data_field =</span> <span class="st">&quot;floodZone&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Set: FimaNfipClaims</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field: floodZone</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Description: Flood zone derived from the Flood Insurance Rate Map (FIRM) used to rate the insured property.A - Special Flood with no Base Flood Elevation on FIRM; AE, A1-A30 - Special Flood with Base Flood Elevation on FIRM; A99 - Special Flood with Protection Zone; AH, AHB* - Special Flood with Shallow Ponding; AO, AOB* - Special Flood with Sheet Flow; X, B - Moderate Flood from primary water source.  Pockets of areas subject to drainage problems; X, C - Minimal Flood from primary water source.  Pockets of areas subject to drainage problems; D - Possible Flood; V - Velocity Flood with no Base Flood Elevation on FIRM; VE, V1-V30 - Velocity Flood with Base Flood Elevation on FIRM; AE, VE, X - New zone designations used on new maps starting January 1, 1986, in lieu of A1-A30, V1-V30, and B and C; AR - A Special Flood Hazard Area that results from the decertification of a previously accredited flood protection system that is determined to be in the process of being restored to provide base flood protection;AR Dual Zones - (AR/AE, AR/A1-A30, AR/AH, AR/AO, AR/A) Areas subject to flooding from failure of the flood protection system (Zone AR) which also overlap an existing Special Flood Hazard Area as a dual zone; *AHB, AOB, ARE, ARH, ARO, and ARA are not risk zones shown on a map, but are acceptable values for rating purposes</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Example Values: c(&quot;AE&quot;, &quot;X&quot;, &quot;C&quot;, &quot;A&quot;, &quot;A10&quot;, &quot;A06&quot;)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; More Information Available at: https://www.fema.gov/about/openfema/data-sets</span></span></code></pre></div>
<p>As can be seen <code>parameter_values()</code> returns the data set name, the data field (i.e. the searchable parameter), a description of the data field which description, and a vector of examples of the data field values which can be useful for seeing how the values are formatted in the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameter_values</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>,<span class="at">data_field =</span> <span class="st">&quot;floodZone&quot;</span>)</span></code></pre></div>
<p>We can see from the above that <code>floodZone</code> is a character in the data and from the description we know that “AE” and “X” are both valid values for the <code>floodZone</code> parameter. We can thus define a filter to return only records from AE or X flood zones.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a filter that limits records to those in AE or X flood zones</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>my_filters <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">floodZone =</span> <span class="fu">c</span>(<span class="st">&quot;AE&quot;</span>,<span class="st">&quot;X&quot;</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pass the filter to the open_fema function.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipPolicies&quot;</span>, <span class="at">top_n =</span> <span class="dv">10</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;policyCount&quot;</span>,<span class="st">&quot;floodZone&quot;</span>), <span class="at">filters =</span> my_filters)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    floodZone policyCount id                      </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;                   </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 AE        1           61ad7aad9bf443f510234c3d</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 AE        1           61ad7aad9bf443f510234c47</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 AE        1           61ad7aad9bf443f510234c55</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 AE        1           61ad7aad9bf443f510234c5b</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 AE        1           61ad7aad9bf443f510234c69</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 AE        1           61ad7aad9bf443f510234cc1</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 AE        1           61ad7aad9bf443f510234cc6</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 AE        1           61ad7aad9bf443f510234cc7</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 AE        1           61ad7aad9bf443f510234cd0</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 AE        1           61ad7aad9bf443f510234cdd</span></span></code></pre></div>
</div>
<div id="more-examples" class="section level2">
<h2>More Examples</h2>
<div id="example-return-the-first-100-nfip-claims-for-autauga-county-al-that-happened-between-2010-and-2020." class="section level3">
<h3>Example: Return the first 100 NFIP claims for Autauga County, AL that happened between 2010 and 2020.</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;fimaNfipClaims&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">top_n =</span> <span class="dv">100</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">filters =</span> <span class="fu">list</span>(<span class="at">countyCode =</span> <span class="st">&quot;= 01001&quot;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">yearOfLoss =</span> <span class="st">&quot;&gt;= 2010&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">yearOfLoss =</span> <span class="st">&quot;&lt;= 2020&quot;</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 20 × 40</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    agricultureStructureIndicator asOfDate            baseFloodElevat… basementEnclosu… reportedCity condominiumIndi… policyCount countyCode communityRating…</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                         &lt;dttm&gt;              &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;           </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 FALSE                         2021-09-08 00:00:00 164              0                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 FALSE                         2021-07-25 00:00:00 NULL             1                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 FALSE                         2021-07-25 00:00:00 184              0                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 FALSE                         2021-07-25 00:00:00 184              0                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 FALSE                         2021-07-25 00:00:00 164              NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      8               </span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 FALSE                         2021-07-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16 FALSE                         2021-07-25 00:00:00 NULL             1                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 FALSE                         2021-07-25 00:00:00 NULL             0                Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 FALSE                         2021-07-25 00:00:00 NULL             1                Temporarily… N                1           01001      8               </span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19 FALSE                         2021-07-25 00:00:00 NULL             0                Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20 FALSE                         2021-10-25 00:00:00 NULL             NULL             Temporarily… N                1           01001      NULL            </span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 31 more variables: dateOfLoss &lt;dttm&gt;, elevatedBuildingIndicator &lt;chr&gt;, elevationCertificateIndicator &lt;chr&gt;, elevationDifference &lt;chr&gt;,</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   censusTract &lt;chr&gt;, floodZone &lt;chr&gt;, houseWorship &lt;chr&gt;, latitude &lt;chr&gt;, longitude &lt;chr&gt;, locationOfContents &lt;chr&gt;, lowestAdjacentGrade &lt;chr&gt;,</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   lowestFloorElevation &lt;chr&gt;, numberOfFloorsInTheInsuredBuilding &lt;chr&gt;, nonProfitIndicator &lt;chr&gt;, obstructionType &lt;chr&gt;, occupancyType &lt;chr&gt;,</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   originalConstructionDate &lt;dttm&gt;, originalNBDate &lt;dttm&gt;, amountPaidOnBuildingClaim &lt;chr&gt;, amountPaidOnContentsClaim &lt;chr&gt;,</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   amountPaidOnIncreasedCostOfComplianceClaim &lt;chr&gt;, postFIRMConstructionIndicator &lt;chr&gt;, rateMethod &lt;chr&gt;, smallBusinessIndicatorBuilding &lt;chr&gt;,</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   state &lt;chr&gt;, totalBuildingInsuranceCoverage &lt;chr&gt;, totalContentsInsuranceCoverage &lt;chr&gt;, yearOfLoss &lt;chr&gt;, reportedZipcode &lt;chr&gt;,</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   primaryResidence &lt;chr&gt;, id &lt;chr&gt;</span></span></code></pre></div>
</div>
<div id="example-get-data-on-all-hazard-mitigation-grants-associated-with-hurricanes-in-florida." class="section level3">
<h3>Example: Get data on all Hazard Mitigation Grants associated with Hurricanes in Florida.</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see which parameter can be used for filtering the Hazard Mitigation Grants data set</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">valid_parameters</span>(<span class="st">&quot;HazardMitigationGrants&quot;</span>) </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 19 × 1</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    params             </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;              </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 id                 </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 projectType        </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 projectCounties    </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 status             </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 subgrantee         </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 disasterNumber     </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 state              </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 projectAmount      </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 region             </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 declarationDate    </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 projectNumber      </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 disasterTitle      </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 projectDescription </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 lastRefresh        </span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 costSharePercentage</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16 subgranteeFIPSCode </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 projectTitle       </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 incidentType       </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19 hash</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co"># see how values of &quot;incidentType&quot; are formatted</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="fu">parameter_values</span>(<span class="at">data_set =</span> <span class="st">&quot;HazardMitigationGrants&quot;</span>, <span class="at">data_field =</span> <span class="st">&quot;incidentType&quot;</span>) </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Set: HazardMitigationGrants</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field: incidentType</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Description: </span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Example Values: c(&quot;Flood&quot;, &quot;Severe Storm(s)&quot;, &quot;Tornado&quot;, &quot;Freezing&quot;, &quot;Hurricane&quot;, &quot;Earthquake&quot;)</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; More Information Available at: https://www.fema.gov/about/openfema/data-sets</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see how &quot;state&quot; is formatted</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">parameter_values</span>(<span class="at">data_set =</span> <span class="st">&quot;HazardMitigationGrants&quot;</span>, <span class="at">data_field =</span> <span class="st">&quot;state&quot;</span>) </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Set: HazardMitigationGrants</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field: state</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Description: string</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data Field Example Values: c(&quot;Kentucky&quot;, &quot;Utah&quot;, &quot;North Dakota&quot;, &quot;Texas&quot;, &quot;North Carolina&quot;, &quot;Alaska&quot;)</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; More Information Available at: https://www.fema.gov/about/openfema/data-sets</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a list containing filters for Hurricane and Florida</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>filter_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">incidentType =</span> <span class="fu">c</span>(<span class="st">&quot;Hurricane&quot;</span>),</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">c</span>(<span class="st">&quot;Florida&quot;</span>)) </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co"># pass filter_list to the open_fema function to retreieve data.</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;HazardMitigationGrants&quot;</span>, <span class="at">filters =</span> filter_list, </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">ask_before_call =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtaining Data: 1 out of 2 iterations (50% complete)</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtaining Data: 2 out of 2 iterations (100% complete)</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,671 × 19</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    region state disasterNumber declarationDate     incidentType disasterTitle projectNumber projectType projectTitle projectDescript… projectCounties status</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;          &lt;dttm&gt;              &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt; </span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0004          401.1: Wat… GIS UTILITY… &quot;Load all water… &quot;BROWARD&quot;       Not A…</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0002          205.8: Ret… WIND RETROF… &quot;Protect buildi… &quot;BROWARD&quot;       Closed</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0003          501.1: Oth… REPLACE TRA… &quot;Replace span w… &quot;BROWARD &quot;      Withd…</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0001          602.1: Oth… RECOVERY MA… &quot;Proposed syste… &quot;STATEWIDE&quot;     Closed</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0019          205.8: Ret… WIND RETROF… &quot;Install shutte… &quot;BROWARD&quot;       Closed</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0014          601.1: Gen… ELEVATE/REL… &quot;Construct engi… &quot;BROWARD&quot;       Withd…</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0018          205.8: Ret… WIND RETROF… &quot;Install shutte… &quot;BROWARD&quot;       Closed</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0049          601.1: Gen… EMERGENCY G… &quot;Purchase and i… &quot;BROWARD&quot;       Not A…</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0029          205.8: Ret… WIND RETROF… &quot;Install shutte… &quot;BROWARD&quot;       Withd…</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 4      Flor… 955            1992-08-24 00:00:00 Hurricane    HURRICANE AN… 0023          602.1: Oth… COMMUNICATI… &quot;Purchase  VHF … &quot;BROWARD&quot;       Not A…</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1,661 more rows, and 7 more variables: subgrantee &lt;chr&gt;, subgranteeFIPSCode &lt;chr&gt;, projectAmount &lt;chr&gt;, costSharePercentage &lt;chr&gt;, hash &lt;chr&gt;,</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   lastRefresh &lt;chr&gt;, id &lt;chr&gt;</span></span></code></pre></div>
</div>
<div id="example-determine-how-much-money-was-awarded-by-fema-for-rental-assistance-following-hurricane-irma." class="section level3">
<h3>Example: Determine how much money was awarded by FEMA for rental assistance following Hurricane Irma.</h3>
<p>Get a dataset description for the <code>HousingAssistanceRenters</code> data set to see if this is the right data set for the question</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get meta data for the `HousingAssistanceRenters`</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">fema_data_sets</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;HousingAssistanceRenters&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># there are two entries corresponding to two versions of the data set, </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we want the most recent one</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ds)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(version <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">as.numeric</span>(ds<span class="sc">$</span>version)))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># now print out the data set description and make sure its the data set </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># is applicable or our research question</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ds<span class="sc">$</span>description)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;The dataset was generated by FEMA&#39;s Enterprise Coordination &amp; Information Management (ECIM) Reporting team and is primarily composed of data from Housing Assistance Program reporting authority from FEMA registration renters and owners within the state, county, zip where the registration is valid. This dataset contains aggregated, non-PII data on FEMA&#39;s Housing Assistance Program within the state, county, zip where the registration is valid for the declarations, starting with disaster declarations number 4116.  The data is divided into data for renters and data for property owners. Additional core data elements include number of applicants, county, zip code, severity of damage, owner or renter. Data is self-reported and as such is subject to human error. To learn more about disaster assistance please visit https://www.fema.gov/individual-disaster-assistance.This is raw, unedited data from FEMA&#39;s National Emergency Management Information System (NEMIS) and as such is subject to a small percentage of human error. For example, when an applicant registers they enter their street and city address.  The system runs a check and suggests a county.  The applicant, if registering online can override that choice.  If they are registering via the call center the Human Services Specialist (HSS) representatives are instructed to ask (not offer) what county they live in.  So even though the system might suggest County A,  an applicant has the right to choose County B.  The financial information is derived from NEMIS and not FEMA&#39;s official financial systems.  Due to differences in reporting periods, status of obligations and how business rules are applied, this financial information may differ slightly from official publication on public websites such as usaspending.gov;  this dataset is not intended to be used for any official federal financial reporting.Citation: The Agency&#39;s preferred citation for datasets (API usage or file downloads) can be found on the OpenFEMA Terms and Conditions page, Citing Data section: https://www.fema.gov/about/openfema/terms-conditions.If you have media inquiries about this dataset, please email the FEMA News Desk FEMA-News-Desk@dhs.gov or call (202) 646-3272.  For inquiries about FEMA&#39;s data and Open government program please contact the OpenFEMA team via email OpenFEMA@fema.dhs.gov.&quot;</span></span></code></pre></div>
<p>See which columns we can filter on to select just Hurricane Irma related grants</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see which parameter can be used for filtering the Housing Assistance for Renters </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">valid_parameters</span>(<span class="st">&quot;HousingAssistanceRenters&quot;</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 44 × 1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    params                    </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                     </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 city                      </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 validRegistrations        </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 disasterNumber            </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 zipCode                   </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 repairReplaceAmount       </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 totalInspected            </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 approvedForFemaAssistance </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 totalWithSubstantialDamage</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 rentalAmount              </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 otherNeedsAmount          </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 34 more rows</span></span></code></pre></div>
<p>All we have in this data set is the <code>disasterNumber</code>. Thus, to filter on a specific disaster we have to load the <code>FemaWebDisasterDeclarations</code> data find the disaster number associated with the event we are interested in.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># call the disaster declarations</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> rfema<span class="sc">::</span><span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;FemaWebDisasterDeclarations&quot;</span>, <span class="at">ask_before_call =</span> F)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtaining Data: 1 out of 5 iterations (20% complete) Obtaining Data: 2 out of 5 iterations (40% complete) Obtaining Data: 3 out of 5 iterations (60%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; complete) Obtaining Data: 4 out of 5 iterations (80% complete) Obtaining Data: 5 out of 5 iterations (100% complete)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter disaster declarations to those with &quot;hurricane&quot; in the name</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>hurricanes <span class="ot">&lt;-</span> <span class="fu">distinct</span>(dd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;hurricane&quot;</span>,<span class="fu">tolower</span>(disasterName))) <span class="sc">%&gt;%</span> <span class="fu">select</span>(disasterName, disasterNumber))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>hurricanes</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 381 × 2</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    disasterName                               disasterNumber</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                      &lt;chr&gt;         </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 HURRICANE MARIA                            3390          </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 HURRICANE IRMA                             3388          </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 HURRICANE NATE                             3395          </span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 HURRICANE HARVEY                           4332          </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 HURRICANE IRMA                             3384          </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 HURRICANE IRMA - SEMINOLE TRIBE OF FLORIDA 4341          </span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 HURRICANE NATE                             3394          </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 HURRICANE IRMA                             4336          </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 HURRICANE NATE                             4349          </span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 HURRICANE IRMA                             3385          </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 371 more rows</span></span></code></pre></div>
<p>We can see immediately that disaster numbers do not uniquely identify an event, since multiple disaster declarations may be declared for the same event, but in different locations. Thus to filter on a particular event, we need to collect all the disaster declaration numbers corresponding to that event (in this case Hurricane Irma).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get all disaster declarations associated with hurricane irma. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice the use of grepl() which picked up a disaster declaration name </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># that was different than all the others.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dd_irma <span class="ot">&lt;-</span> hurricanes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;irma&quot;</span>,<span class="fu">tolower</span>(disasterName)))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>dd_irma</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 13 × 2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    disasterName                               disasterNumber</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                      &lt;chr&gt;         </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 HURRICANE IRMA                             3388          </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 HURRICANE IRMA                             3384          </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 HURRICANE IRMA - SEMINOLE TRIBE OF FLORIDA 4341          </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 HURRICANE IRMA                             4336          </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 HURRICANE IRMA                             3385          </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 HURRICANE IRMA                             4346          </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 HURRICANE IRMA                             3383          </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 HURRICANE IRMA                             3389          </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 HURRICANE IRMA                             4338          </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 HURRICANE IRMA                             3386          </span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 HURRICANE IRMA                             4335          </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 HURRICANE IRMA                             3387          </span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 HURRICANE IRMA                             4337</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># get a vector of just the disaster declaration numbers</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>dd_nums_irma <span class="ot">&lt;-</span> dd_irma<span class="sc">$</span>disasterNumber</span></code></pre></div>
<p>Now we are read to filter our API call for the <code>HousingAssistanceRenters</code> data set.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct filter list</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>filter_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">disasterNumber =</span> dd_nums_irma)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make the API call to get individual assistance grants awarded to renters for hurricane Irma damages.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>assistance_irma <span class="ot">&lt;-</span> <span class="fu">open_fema</span>(<span class="at">data_set =</span> <span class="st">&quot;HousingAssistanceRenters&quot;</span>, <span class="at">filters =</span> filter_list, <span class="at">ask_before_call =</span> F)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtaining Data: 1 out of 6 iterations (16.67% complete) Obtaining Data: 2 out of 6 iterations (33.33% complete) Obtaining Data: 3 out of 6 iterations</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (50% complete) Obtaining Data: 4 out of 6 iterations (66.67% complete) Obtaining Data: 5 out of 6 iterations (83.33% complete) Obtaining Data: 6 out of 6</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iterations (100% complete)</span></span></code></pre></div>
<p>Check out the returned data</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check out the returned data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>assistance_irma</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5,353 × 21</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    state validRegistrations totalInspected totalInspectedWithNoDamage totalWithModerat… totalWithMajorDa… totalWithSubsta… approvedForFema… totalApprovedIh…</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;              &lt;chr&gt;          &lt;chr&gt;                      &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 VI    1                  0              1                          0                 0                 0                0                0               </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 VI    2                  1              2                          0                 0                 0                1                2401.64         </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 VI    1                  1              0                          1                 0                 0                1                2816            </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 VI    1                  1              0                          1                 0                 0                1                4476.9          </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 VI    4                  4              2                          1                 0                 0                4                6360            </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 VI    1                  1              0                          1                 0                 0                1                2122            </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 VI    1                  0              1                          0                 0                 0                0                0               </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 VI    1                  1              1                          0                 0                 0                1                499.99          </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 VI    3                  2              2                          1                 0                 0                1                2622            </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 VI    1                  1              0                          1                 0                 0                1                3548.62         </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 5,343 more rows, and 12 more variables: repairReplaceAmount &lt;chr&gt;, rentalAmount &lt;chr&gt;, otherNeedsAmount &lt;chr&gt;, approvedBetween1And10000 &lt;chr&gt;,</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   approvedBetween10001And25000 &lt;chr&gt;, approvedBetween25001AndMax &lt;chr&gt;, totalMaxGrants &lt;chr&gt;, disasterNumber &lt;chr&gt;, zipCode &lt;chr&gt;, county &lt;chr&gt;,</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   city &lt;chr&gt;, id &lt;chr&gt;</span></span></code></pre></div>
<p>Now we can answer our original question: How much did FEMA awarded for rental assistance following Hurricane Irma?</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum the rentalAmount Column</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>rent_assistance <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(assistance_irma<span class="sc">$</span>rentalAmount))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># scale to millions</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>rent_assistance <span class="ot">&lt;-</span> rent_assistance<span class="sc">/</span><span class="dv">1000000</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;$&quot;</span>,<span class="fu">round</span>(rent_assistance,<span class="dv">2</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot; million was awarded by FEMA for rental assistance following Hurricane Irma&quot;</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;$314.64 million was awarded by FEMA for rental assistance following Hurricane Irma&quot;</span></span></code></pre></div>
</div>
</div>
<div id="bulk-downloads" class="section level2">
<h2>Bulk Downloads</h2>
<p>In some cases bulk downloading a full data set file may be preferred. For particularly large data requests, its usually faster to bulk download the entire data set as a csv file and then load it into the R environment. In this case, users can use the bulk_dl() command to download a csv of the full data file and save it to a specified directory.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bulk_dl</span>(<span class="st">&quot;femaRegions&quot;</span>) <span class="co"># download a csv file containing all info on FEMA regions</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Downloading file to /home/dylan/Dropbox/rfema/vignettes/FemaRegions.csv</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
